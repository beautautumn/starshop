# TDD 方法概要

### 测试设计方法

1. 基于业务用例规格说明的"验收标准"；
2. 基于服务任务分解，逐步从原子任务（聚合或端口）、到组合任务（领域服务）、到应用服务；
3. 考虑各种正常和异常的逻辑分支覆盖；

### TDD三定律

1. 一次只写一个刚好失败的测试，作为新加功能的"精炼文档"；
2. 不写任何产品功能代码，除非它刚好让失败的测试通过；
3. 只在测试全部通过的情况下做代码重构，或开始新加功能开发；

### TDD三重奏
* 红灯： 编写测试，测试失败，进入第二奏；
* 绿灯： 编写代码，测试通过，进入第三奏；
* 重构： 优化代码和测试，回到第一奏；

### 测试代码编写 FIRST 原则

* F: Fast              快速，每个测试运行非常快，能够做到每秒执行几百甚至几千个；
* I: Isolated          独立，每个测试能够清晰的隔离一个失败，不会组合多个失败；
* R: Repeatable        可复现，每个测试都可重复多次运行，且每次以同样的方式成功或失败；
* S: Self-verifying    自我验证，每个测试自动化的判定成功或失败，无需人工观察或干预；
* T: Timely            及时，测试必须及时编写、更新和维护

### 产品功能代码编写原则（优先级由高到低）

1. 功能正确：通过所有测试；
2. 减少重复：尽可能避免重复，抽取提炼公共逻辑。注意，是"尽可能"不是"完全无"重复；
3. 代码可读：尽可能清晰表达，针对核心领域的业务逻辑，考虑引入领域内部的统一语言来表达实现逻辑；
4. 更少代码：做恰如其分的设计，只要做到了减少重复和代码可读，就不要进一步拆分代码元素；